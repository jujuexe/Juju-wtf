<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Juju Casino â€“ Mines</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      background: #111;
      color: #fff;
      font-family: 'Arial', sans-serif;
      display: flex;
      justify-content: flex-start;
      align-items: flex-start;
      padding: 20px;
    }

    .left-panel {
      width: 350px;
    }

    #token-count {
      font-size: 22px;
      margin-bottom: 20px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(5, 60px);
      grid-gap: 10px;
      margin-top: 20px;
    }

    .tile {
      width: 60px;
      height: 60px;
      background: #222;
      border: 1px solid #444;
      cursor: pointer;
      font-size: 24px;
      line-height: 60px;
      user-select: none;
      text-align: center;
    }

    .tile.revealed {
      background: #1e1e1e;
      color: #0f0;
    }

    .tile.mine {
      background: #900;
      color: #fff;
    }

    select, button {
      padding: 10px;
      margin: 10px 0;
      background: #333;
      color: white;
      border: none;
      font-size: 16px;
      border-radius: 6px;
      width: 100%;
    }

    #profit-display {
      font-size: 18px;
      margin-top: 10px;
      color: #0f0;
    }

    #status {
      margin-top: 10px;
    }

    #game-info {
      margin: 10px 0;
      font-size: 16px;
      color: #aaa;
    }

    #cashout-modal .modal-box {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(20, 20, 20, 0.95);
      padding: 30px;
      border-radius: 12px;
      text-align: center;
      color: white;
      z-index: 9999;
      box-shadow: 0 0 20px #000;
      width: 300px;
      animation: fadeInUp 0.5s ease-out;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translate(-50%, -60%);
      }
      to {
        opacity: 1;
        transform: translate(-50%, -50%);
      }
    }

    #cashout-modal button.close-btn {
      position: absolute;
      top: 10px;
      right: 15px;
      background: #900;
      border: none;
      color: white;
      font-size: 20px;
      padding: 4px 10px;
      cursor: pointer;
      border-radius: 5px;
    }
  </style>
</head>
<body>

  <div class="left-panel">
    <h1>ðŸ’£ Juju Mines</h1>
    <div id="token-count">Tokens: <span id="tokens">25000</span></div>

    <label for="mine-count">Number of Mines:</label>
    <select id="mine-count"></select>

    <!-- Game Control -->
    <div id="game-control">
      <button id="game-btn" onclick="handleGameClick()">Start Game</button>
    </div>

    <!-- Game Info While Playing -->
    <div id="game-info" style="display: none;">
      <div>ðŸ’° Current Cashout: <span id="current-profit">0</span> tokens</div>
      <div>ðŸ“ˆ Multiplier: <span id="current-multiplier">x0.00</span></div>
      <button onclick="cashOut()" style="margin-top: 10px; background: #0a0;">ðŸ’° Cash Out</button>
    </div>

    <div class="grid" id="grid"></div>
    <div id="profit-display">ðŸ’° Profit This Round: 0</div>
    <div id="status"></div>
  </div>

  <!-- Cashout Modal -->
  <div id="cashout-modal" style="display:none;">
    <div class="modal-box">
      <button class="close-btn" onclick="closeCashoutModal()">X</button>
      <h2>ðŸ’° Cashed Out!</h2>
      <p id="cashout-amount" style="font-size: 24px; margin: 10px 0;"></p>
      <p id="cashout-multiplier" style="font-size: 18px; color: #aaa;"></p>
    </div>
  </div>

  <script>
    let tokens = 25000;
    let minePositions = [];
    let revealedTiles = new Set();
    let gameActive = false;
    let mines = 3;
    let currentProfit = 0;
    let currentMultiplier = 0;

    const mineDropdown = document.getElementById("mine-count");
    for (let i = 1; i <= 24; i++) {
      const option = document.createElement("option");
      option.value = i;
      option.textContent = i;
      mineDropdown.appendChild(option);
    }

    function updateTokensDisplay() {
      document.getElementById("tokens").textContent = tokens;
    }

    function updateProfitDisplay() {
      document.getElementById("profit-display").textContent = `ðŸ’° Profit This Round: ${currentProfit}`;
      document.getElementById("current-profit").textContent = currentProfit;
      document.getElementById("current-multiplier").textContent = `x${currentMultiplier.toFixed(2)}`;
    }

    function startGame() {
      mines = parseInt(mineDropdown.value);
      minePositions = generateMines(mines);
      revealedTiles.clear();
      gameActive = true;
      currentProfit = 0;
      currentMultiplier = 0;

      updateProfitDisplay();
      document.getElementById("game-btn").style.display = "none";
      document.getElementById("game-info").style.display = "block";
      document.getElementById("status").textContent = "";
      renderGrid();
    }

    function endGame() {
      gameActive = false;
      document.getElementById("game-btn").style.display = "block";
      document.getElementById("game-info").style.display = "none";
      document.getElementById("game-btn").textContent = "Start Game";
    }

    function handleGameClick() {
      if (!gameActive) {
        startGame();
      }
    }

    function generateMines(count) {
      const positions = new Set();
      while (positions.size < count) {
        positions.add(Math.floor(Math.random() * 25));
      }
      return [...positions];
    }

    function renderGrid() {
      const grid = document.getElementById("grid");
      grid.innerHTML = "";
      for (let i = 0; i < 25; i++) {
        const tile = document.createElement("div");
        tile.className = "tile";
        tile.dataset.index = i;
        tile.onclick = () => revealTile(i, tile);
        grid.appendChild(tile);
      }
    }

    function revealTile(index, tile) {
      if (!gameActive || revealedTiles.has(index)) return;

      if (minePositions.includes(index)) {
        tile.classList.add("mine");
        tile.textContent = "ðŸ’¥";
        document.getElementById("status").textContent = "You hit a mine! ðŸ’€ Profit lost.";
        currentProfit = 0;
        updateProfitDisplay();
        endGame();
        return;
      }

      revealedTiles.add(index);
      tile.classList.add("revealed");
      tile.textContent = "ðŸ’Ž";

      const safeTiles = 25 - mines;
      currentMultiplier = 1 / (1 - (revealedTiles.size / safeTiles));
      currentProfit = Math.floor(100 * currentMultiplier);

      updateProfitDisplay();

      if (revealedTiles.size === safeTiles) {
        document.getElementById("status").textContent = "You cleared the board!";
        endGame();
      }
    }

    function cashOut() {
      if (!gameActive || currentProfit <= 0) return;

      tokens += currentProfit;
      updateTokensDisplay();

      document.getElementById("cashout-amount").textContent = `+${currentProfit} Tokens`;
      document.getElementById("cashout-multiplier").textContent = `Multiplier: x${currentMultiplier.toFixed(2)}`;
      document.getElementById("cashout-modal").style.display = 'block';

      currentProfit = 0;
      updateProfitDisplay();
      endGame();
    }

    function closeCashoutModal() {
      document.getElementById("cashout-modal").style.display = "none";
    }

    // Init
    updateTokensDisplay();
    renderGrid();
  </script>

</body>
</html>
