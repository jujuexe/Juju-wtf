<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Juju Casino â€“ Mines</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      background: #111;
      color: #fff;
      font-family: 'Arial', sans-serif;
      text-align: center;
      padding: 20px;
    }

    #token-count {
      font-size: 22px;
      margin-bottom: 20px;
    }

    .game {
      margin-top: 30px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(5, 60px);
      grid-gap: 10px;
      justify-content: center;
      margin: 20px 0;
    }

    .tile {
      width: 60px;
      height: 60px;
      background: #222;
      border: 1px solid #444;
      cursor: pointer;
      font-size: 24px;
      line-height: 60px;
      user-select: none;
    }

    .tile.revealed {
      background: #1e1e1e;
      color: #0f0;
    }

    .tile.mine {
      background: #900;
      color: #fff;
    }

    select, button {
      padding: 10px;
      margin: 10px;
      background: #333;
      color: white;
      border: none;
      font-size: 16px;
      border-radius: 6px;
    }

    #cashout-btn {
      background: #0a0;
    }

    #cashout-modal {
      display: none;
    }

    /* Modal Styling */
    #cashout-modal .modal-box {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(20, 20, 20, 0.95);
      padding: 30px;
      border-radius: 12px;
      text-align: center;
      color: white;
      z-index: 9999;
      box-shadow: 0 0 20px #000;
      width: 300px;
    }

    #cashout-modal button.close-btn {
      position: absolute;
      top: 10px;
      right: 15px;
      background: #900;
      border: none;
      color: white;
      font-size: 20px;
      padding: 4px 10px;
      cursor: pointer;
      border-radius: 5px;
    }
  </style>
</head>
<body>

  <h1>ðŸ’£ Juju Casino â€“ Mines</h1>
  <div id="token-count">Tokens: <span id="tokens">25000</span></div>

  <div class="game">
    <label for="mine-count">Number of Mines:</label>
    <select id="mine-count"></select>
    <button onclick="startGame()">Start Game</button>

    <div class="grid" id="grid"></div>
    <button id="cashout-btn" onclick="cashOut()" disabled>ðŸ’° Cash Out</button>
    <div id="status"></div>
  </div>

  <!-- Cashout Modal -->
  <div id="cashout-modal">
    <div class="modal-box">
      <button class="close-btn" onclick="closeCashoutModal()">X</button>
      <h2>ðŸ’° Cashed Out!</h2>
      <p id="cashout-amount" style="font-size: 24px; margin: 10px 0;"></p>
      <p id="cashout-multiplier" style="font-size: 18px; color: #aaa;"></p>
    </div>
  </div>

  <script>
    let tokens = 25000;
    let minePositions = [];
    let revealedTiles = new Set();
    let gameActive = false;
    let mines = 3;

    // Populate dropdown
    const mineDropdown = document.getElementById("mine-count");
    for (let i = 1; i <= 24; i++) {
      const option = document.createElement("option");
      option.value = i;
      option.textContent = i;
      mineDropdown.appendChild(option);
    }

    function updateTokensDisplay() {
      document.getElementById("tokens").textContent = tokens;
    }

    function startGame() {
      mines = parseInt(mineDropdown.value);
      minePositions = generateMines(mines);
      revealedTiles.clear();
      gameActive = true;
      document.getElementById("cashout-btn").disabled = false;
      document.getElementById("status").textContent = "";
      renderGrid();
    }

    function generateMines(count) {
      const positions = new Set();
      while (positions.size < count) {
        positions.add(Math.floor(Math.random() * 25));
      }
      return [...positions];
    }

    function renderGrid() {
      const grid = document.getElementById("grid");
      grid.innerHTML = "";
      for (let i = 0; i < 25; i++) {
        const tile = document.createElement("div");
        tile.className = "tile";
        tile.dataset.index = i;
        tile.onclick = () => revealTile(i, tile);
        grid.appendChild(tile);
      }
    }

    function revealTile(index, tile) {
      if (!gameActive || revealedTiles.has(index)) return;

      if (minePositions.includes(index)) {
        tile.classList.add("mine");
        tile.textContent = "ðŸ’¥";
        document.getElementById("status").textContent = "You hit a mine! Game over.";
        gameActive = false;
        document.getElementById("cashout-btn").disabled = true;
        return;
      }

      revealedTiles.add(index);
      tile.classList.add("revealed");
      tile.textContent = "ðŸ’Ž";

      if (revealedTiles.size === 25 - mines) {
        document.getElementById("status").textContent = "You cleared the board!";
        document.getElementById("cashout-btn").disabled = true;
        gameActive = false;
      }
    }

    function cashOut() {
      if (!gameActive) return;

      const diamondsClicked = revealedTiles.size;
      const totalTiles = 25;
      const safeTiles = totalTiles - mines;

      const fairMultiplier = (1 / (1 - (diamondsClicked / safeTiles))).toFixed(2);
      const reward = Math.floor(100 * fairMultiplier);

      tokens += reward;
      updateTokensDisplay();

      document.getElementById("cashout-amount").textContent = `+${reward} Tokens`;
      document.getElementById("cashout-multiplier").textContent = `Multiplier: x${fairMultiplier}`;
      document.getElementById("cashout-modal").style.display = 'block';

      gameActive = false;
      document.getElementById("cashout-btn").disabled = true;
      document.getElementById("status").textContent = "You cashed out!";
    }

    function closeCashoutModal() {
      document.getElementById("cashout-modal").style.display = "none";
    }

    updateTokensDisplay();
    renderGrid();
  </script>

</body>
</html>
